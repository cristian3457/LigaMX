<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tabla de Posiciones</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <head>
<style>
    *{
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }
    .navbar1{
        overflow: hidden;
        background-color: black;
    }
    .item-navbar{
        float: left;
        display: block;
        color: white;
        text-align: center;
        padding: 10px 15px;
        text-decoration: none;
    }
    .navbar1 a:hover{
        color:black !important;
        background-color: white;
    }
    .icono{
        display: block;
    }
    #overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(144, 144, 144, 0.5); /* Fondo semitransparente */
    z-index: 999; /* Valor alto para estar encima de otros elementos */
    display: none; /* Inicialmente oculto */
    }
    .centrar{
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100vh;
    }
/* .elemento-padre:hover .dropdown-menu {
    display: block;
} */
@media screen and (max-width:576px) {
    .navbar1 a{
        width: 100%;
    }
    .elemento-padre:hover .dropdown-menu {
        display: none;
    }
}
.visible{
    display: none;
    color: white;
    background-color: black;
    position: absolute;
    top: 65px;
    width: 100%;
}
.padre-menu:hover .visible{
    display: block;
}
.item-desplegable{
    display: block;
    text-decoration: none;
    text-align: center;
    padding: 10px 12px;
    overflow: hidden;
}
ol, ul {
    padding-left: 0px !important;
}
.item-desplegable:hover{
cursor: pointer;
background-color: white;
color: black;

}
.tabs{
    cursor: pointer;
}
.tabActivo{
    background-color: white;
    color: black;
}
</style>
<body>
    <div id="overlay">
        <div class="centrar">
            <div class="spinner-border text-primary"  style="width: 4rem; height: 4rem;" role="status">
                <span class="visually-hidden" role="status">Loading...</span>
            </div>
        </div>
    </div>
    <div class="navbar1">
        <a href="index.html" id="home" class="item-navbar">
            <i class="bi bi-house-fill icono" ></i>
            Home
        </a>
        <a href="equipos.html" id="equipos" class="item-navbar">
            <i class="bi bi-shield-fill-plus icono" ></i>
            Equipos
        </a>
        <a class="item-navbar" href="jugadores.html">
            <i class="bi bi-person-lines-fill icono"></i>
            Jugadores
        </a>
        <a class="item-navbar" href="jornadas.html">
            <i class="bi bi-calendar3 icono"></i>
            Jornadas
        </a>
        <a class="item-navbar tabActivo" href="posiciones.html">
            <i class="bi bi-table icono"></i>
            Posiciones
        </a>
        <a class="item-navbar" href="uniformes.html">
            <i class="bi bi-shop icono"></i>
            Jersys
        </a>
        <div class="elemento-padre">
            <a class="item-navbar dropdown-toggle" id="perfil" href="#" style="float: right;" role="button" data-bs-toggle="dropdown" aria-expanded="true">
                <i class="bi bi-person-circle icono"></i>
                Perfil
            </a>
            <ul class="dropdown-menu text-center" id="perfil-dropdown" data-popper-escaped="" data-popper-placement="bottom-end" style="position: absolute; inset: 0px 0px auto auto; margin: 0px; transform: translate(0px, 70px);">
                <li><a class="dropdown-item" href="#">Mi Información <i class="bi bi-info-circle-fill"></i></a></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="login.html">Logout  <i class="bi bi-box-arrow-right"></i></a></li>
            </ul>
        </div>


        
    </div>

    <div class="container border border-success-subtle p-3 mt-3 mb-3 rounded-2">
        <h1 class="text-success text-center">TABLE DE POSICIONES</h1>
    </div>
    <div class="container collapse-show mt-3" id="listTable">
        <div class="my-3">
            <label class="form-label d-inline-block me-3 fw-semibold">MOSTRAR</label>
            <select class="form-select d-inline-block" style="width: auto !important;" id="showEntries">
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="15">15</option>
                <option value="20">20</option>
            </select>
            <label class="form-label d-inline-block ms-3 fw-semibold">REGISTROS</label>
        </div>
        <table class="table table-bordered" id="tablaEquipos">
            <thead class="table-dark text-center">
              <tr>
                <th scope="col">#</th>
                <th scope="col">Equipo</th>
                <th scope="col">PJ</th>
                <th scope="col">G</th>
                <th scope="col">E</th>
                <th scope="col">P</th>
                <th scope="col">GF</th>
                <th scope="col">GC</th>
                <th scope="col">DG</th>
                <th scope="col">PTS</th>
              </tr>
            </thead>
            <tbody>
            </tbody>
          </table>
          <nav aria-label="Page navigation example">
            <ul class="pagination" id="pagination">

            </ul>
          </nav>
    </div>
    
</body>
<script>
    const TABLAEQUIPOS = document.getElementById('tablaEquipos');
    const CUERPOTABLA = TABLAEQUIPOS.getElementsByTagName('tbody')[0];
    const SHOWENTRIES = document.getElementById('showEntries');
    
    var TotalPaginas = 0;
    let numeroRegistros = 5;
    let paginaActual = 1;
    
    SHOWENTRIES.addEventListener('change',function(){
        numeroRegistros = SHOWENTRIES.value;
        console.log(numeroRegistros)
        paginaActual = 1;
        pintarTabla(1);
        pintarPaginacion();
    });

    async function obtenerDatos(posInicial = 0, posFinal = numeroRegistros) {
        try {
            const resultado = await fetch('https://www.thesportsdb.com/api/v1/json/3/lookuptable.php?l=4350&s=2023-2024');
            if (!resultado.ok) {
            throw new Error('La solicitud no fue exitosa');
            }
            const datos = await resultado.json();
            TotalPaginas = Math.ceil(datos.table.length/numeroRegistros);
            if( posFinal == -1){
                return datos.table;
            }
            return datos.table.slice(posInicial, posFinal);
        } catch (error) {
            throw new Error('Ocurrio el siguiente error:', error);
        }
    }
    function pintarTabla (paginaActual = 1){
        mostrarOverlay();
        CUERPOTABLA.innerHTML = '';
        let posInicial = paginaActual == 1 ? 0 : (paginaActual - 1) * numeroRegistros ;
        let posFinal = paginaActual * numeroRegistros;
        let numeroItem = paginaActual == 1 ? 1 : ((paginaActual - 1) * numeroRegistros) + 1 ;
            obtenerDatos(posInicial,posFinal).then(data => {
                const LongitudData = data.length;
                for (let contador = 0; contador < LongitudData; contador++) {
                    var fila = document.createElement('tr');
                    var columna1 = document.createElement('td');
                    var columna2 = document.createElement('td');
                    var columna3 = document.createElement('td');
                    var columna4 = document.createElement('td');
                    var columna5 = document.createElement('td');
                    var columna6 = document.createElement('td');
                    var columna7 = document.createElement('td');
                    var columna8 = document.createElement('td');
                    var columna9 = document.createElement('td');
                    var columna10 = document.createElement('td');
                    columna1.textContent = contador + numeroItem;
                    columna2.innerHTML = `<img src="${data[contador]['strTeamBadge']}" width="40px" alt="${data[contador]['strTeam']}"><span> ${data[contador]['strTeam']}</span>`;
                    columna3.textContent = data[contador]['intPlayed'];
                    columna4.textContent = data[contador]['intWin'];
                    columna5.textContent = data[contador]['intDraw'];
                    columna6.textContent = data[contador]['intLoss'];
                    columna7.textContent = data[contador]['intGoalsFor'];
                    columna8.textContent = data[contador]['intGoalsAgainst'];
                    columna9.textContent = data[contador]['intGoalDifference'];
                    columna10.textContent = data[contador]['intPoints'];
                    fila.appendChild(columna1);
                    fila.appendChild(columna2);
                    fila.appendChild(columna3);
                    fila.appendChild(columna4);
                    fila.appendChild(columna5);
                    fila.appendChild(columna6);
                    fila.appendChild(columna7);
                    fila.appendChild(columna8);
                    fila.appendChild(columna9);
                    fila.appendChild(columna10);
                    fila.id = data[contador]['idTeam'];
                    CUERPOTABLA.appendChild(fila);
                }
                ocultarOverlay();
            });
    }
    function pintarPaginacion(){
        mostrarOverlay();
        obtenerDatos(0, -1).then(datos =>{
            TotalPaginas = Math.ceil(datos.length / numeroRegistros);
            let cadena = "";
            const PAGINATION = document.getElementById('pagination');
            PAGINATION.innerHTML = "";
            cadena = `<li class="page-item"><a class="page-link" id="previousPage" onClick="cambiarPagina('previousPage',-1)" href="#">Previous</a></li>`;
            for (let index = 1; index <= TotalPaginas; index++) {
                cadena += `<li class="page-item"><a class="page-link" onClick="cambiarPagina('Page${index}',${index})" id="Page${index}" href="#">${index}</a></li>`;
            }
            cadena+= `<li class="page-item"><a class="page-link" onClick="cambiarPagina('nextPage',1)" id="nextPage" href="#">Next</a></li>`;
            PAGINATION.innerHTML = cadena;
            const PREVIOUSPAGE = document.getElementById('previousPage');
            PREVIOUSPAGE.removeAttribute('href');
            PREVIOUSPAGE.style.opacity='0.5';
            PREVIOUSPAGE.style.cursor='not-allowed';
            const PAGINA1 = document.getElementById('Page1');
            PAGINA1.style.backgroundColor = 'blue';
            PAGINA1.style.color = 'white';
            ocultarOverlay();
        })

    }
    function cambiarPagina(idPagina,pagina){
        if(idPagina == 'nextPage'){
            pagina = paginaActual + pagina;
            idPagina = 'Page'+pagina;
        }else if (idPagina == 'previousPage'){
            pagina = paginaActual + pagina;
            idPagina = 'Page'+pagina;
        }
        if(paginaActual != pagina){
            const PAGINAANTERIOR = document.getElementById('Page'+paginaActual);
            PAGINAANTERIOR.style.backgroundColor = 'white';
            PAGINAANTERIOR.style.color = 'blue';
            paginaActual = pagina;
            pintarTabla(paginaActual)
            const PAGINAACTUAL = document.getElementById(idPagina);
            PAGINAACTUAL.style.backgroundColor = 'blue';
            PAGINAACTUAL.style.color = 'white';
        }
        const PREVIOUSPAGE = document.getElementById('previousPage');
        const NEXTPAGE = document.getElementById('nextPage');
        if(paginaActual == 1){
            PREVIOUSPAGE.removeAttribute('href');
            PREVIOUSPAGE.style.opacity='0.5';
            PREVIOUSPAGE.style.cursor='not-allowed';
        }else{
            PREVIOUSPAGE.setAttribute('href','#');
            PREVIOUSPAGE.style.opacity='1';
            PREVIOUSPAGE.style.cursor='pointer';
        }
        if(TotalPaginas == paginaActual){
            NEXTPAGE.removeAttribute('href');
            NEXTPAGE.style.opacity='0.5';
            NEXTPAGE.style.cursor='not-allowed';
        }else{
            NEXTPAGE.setAttribute('href','#');
            NEXTPAGE.style.opacity='1';
            NEXTPAGE.style.cursor='pointer';
        }
    }
    function mostrarOverlay() {
            document.getElementById("overlay").style.display = "block";
            console.log("se esta mostrando el overlay")
        }
    // Para ocultar la capa de superposición y desbloquear la pantalla
    function ocultarOverlay() {
        document.getElementById("overlay").style.display = "none";
    }
    window.onload=function(){
        // OMDb API
// https://www.thesportsdb.com/api.php
        // https://www.thesportsdb.com/api/v1/json/3/search_all_teams.php?l=Mexican%20Primera%20League
        pintarTabla();
        pintarPaginacion();

    };
</script>
</html>

